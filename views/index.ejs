<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>GIF 채팅방</title>
</head>
<body>
<div>
    <table id="kr">
        <tr>
            <th>제목</th>
            <th>종류</th>
            <th>허용 인원</th>
            <th>방장</th>
        </tr>
        <% if (rooms) { %>
            <% for (const room of rooms) { %>
                <tr>
                    <td><%= room.title %></td>
                    <td><%= room.password %></td>
                    <td><%= room.count %></td>
                    <td><%= room.owner %></td>
                </tr>
            <% } %>
        <% } %>
    </table>

    <a href="/create"> 방 만들기 </a>
</div>
<script src="/socket.io/socket.io.js"></script>
<script>
    const socket = io.connect('http://localhost:8005', {
        path: '/socket.io',
        transports: ['websocket'],
    });
    socket.on('newRoom',function (data) {
        const table = document.getElementById('kr');
        const tr = document.createElement('tr');
        let td = document.createElement('td');
        td.textContent = data.title
        tr.appendChild(td);
        td = document.createElement('td');
        td.textContent = data.password ? '비밀방' : '공개방';
        tr.appendChild(td);
        td = document.createElement('td');
        td.textContent = data.count
        tr.appendChild(td);
        td = document.createElement('td');
        td.textContent = data.owner
        tr.appendChild(td);
        table.appendChild(tr);
    });
</script>
</body>
</html>